---
layout: post
title: Malware Taxonomy: Background Info
---
It is imperative that analysts know how to identify, classify, and describe attributes of different types of malware so they can effectively triage systems, implement countermeasures, and develop intelligence that can be shared with the community. Removing a rootkit can be vastly different than eradicating a virus or quarantining a worm and performing these functions incorrectly can lead to reinfection, or a secondary outbreak. Knowing how to properly identify and handle different types of malware can help avoid these pitfalls.

> Trivia: The term “in the wild” originates from “The WildList International”, an organization who maintains a list of malware that exists outside of research laboratories, also known as “zoos”. WildList International has been receiving reports from security researchers at antivirus and security companies since 1996. The current list is available here: http://www.wildlist.org/CurrentList.txt

## TL;DR:

### Malware History:
Most reference books on malware start their timelines in 1981 with ELK Cloner, but people have been experimenting with malware since the 1970's. 
-	https://en.wikipedia.org/wiki/Timeline_of_computer_viruses_and_worms
-	http://malware.wikia.com/wiki/Timeline_of_noteworthy_computer_malware

### Classifying Malware:
Advanced Malware Analysis describes malware taxonomy as <cite>"the process of classifying malware into different groups using a systematic approach based on its characteristics or attributes"</cite> [2].

#### Why Classify Malware?
- Malware analysis yields an understanding of a sample's purpose, directive, and primary function, organizing this data results in recognizable relationship patterns between groups.
- Familiarity with these patterns allows you to identify a sample's class and predict its behavior.
- New classes are created when a sample's characteristics/attributes don't fit into an existing class facilitating expansion of our understanding of malware.
-  Expedites analysis - allows you to make educated guesses about your samples functionality based on its classification, then confirm your hypothesis.

#### Is there a Standard for Malware Taxonomy?
- The short answer, No. But, there are a few classification systems available (see the AV & MAEC sections below).

##### Anti-virus Industry CARO/EICAR:
- Antivirus (AV) vendors (and Windows Defender) use Computer Antivirus Research Organization (CARO) and European Institute for Computer Antivirus Research (EICAR).
- CARO and EICAR were established in 1990's and collaborated on the EICAR test file which validates the integrity of an AV engine.
- Both organizations use a basic naming convention that includes family name, platform, and capabilities...unfortunately, these names are not standard across the AV industry, which makes it hard to share information.

##### MAEC/MISP
MITRE created <cite>"Malware Attribute Enumeration and Characterization (MAEC™) (pronounced “mike”) [which] is a community-developed structured language for encoding and sharing high-fidelity information about malware based upon attributes such as behaviors, artifacts, and relationships between malware samples" </cite> [4].

- Defines data types like boolean, dictionary, strings, etc. 
- Defines top-level objects like behavior, collection, malware action, family, and instance
- Defines relationship types
- Provides a vocabulary specification
- Uses JSON (allows for machine tagging)

#### What are Classifications Based on?
##### In general:
- Operating system, or platform
- Infection vector
- Spreading mechanism
- Fuzzy hash
- Objective:
  - mass: infect as many systems as possible, most common, less sophisticated, detect/prevent with countermeasures
  - targeted: target an entity, less common, more sophisticated, circumvent countermeasures

##### CARO/EICAR:
- Type: describes what malware does on a system
- Platform: describes the operating system the malware targets, but also indicates programming languages and file formats
- Family: characteristics, attribution to malware author (note: often not uniform between vendors)
- Variant letter: sequential versioning across families (ex: AF, then AE)
- Additional information: extra info regarding the malware, such as components

##### MISP Taxonomy:
- Malware Categories and Obfuscation Classification - https://github.com/MISP/misp-taxonomies/tree/master/malware_classification

##### MITRE (MAEC):
- Attributes - https://collaborate.mitre.org/ema/index.php/ema:Attributes
- Capabilities - https://collaborate.mitre.org/ema/index.php/ema:Capabilities
- Behaviors - https://collaborate.mitre.org/ema/index.php/ema:Behaviors

> #### Note:
- Malware typically doesn't fall into just one category.
- A Malware author's main concern when coding is directive (do the coded instructions achieve the author's purpose?).
- Most malware exhibits two or more behaviors, so you should tag samples with every class it belongs to [2].

### References:
1. http://www.wildlist.org/
2. Advanced Malware Analysis
3. Practical Malware Analysis
4. https://maecproject.github.io/
5. https://securityintelligence.com/how-to-choose-the-right-malware-classification-scheme-to-improve-incident-response/
6. http://www.caro.org/index.html
7. http://www.eicar.org
8. https://www.microsoft.com/en-us/wdsi/help/malware-naming
